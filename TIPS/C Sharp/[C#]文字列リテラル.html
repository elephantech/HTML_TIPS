<!DOCTYPE html>

<html lang="ja">
<!-- --------------------------------------
head
--------------------------------------- -->
<head>
<meta content="text/html" charset="utf-8" http-equiv="Content-Type" />

<!-- 基準URI -->
<base href="file:///G:/共有ドライブ/098-all-employees/tips/HTML_TIPS/">

<!-- スタイルシート -->
<link rel="stylesheet" href="_Assets/Sytle001.css" type="text/css">

<!-- スクリプト -->
<!-- タイトル表示 -->
<script src="_Assets/MakeTitle.js" type="text/javascript"></script>
<!-- 目次表示 -->
<script src="_Assets/MakeToc.js" type="text/javascript"></script>



</head>

<!-- --------------------------------------
body
--------------------------------------- -->
<body>
<!-- ページタイトル(ページ内表示) -->
<span id="title"></span>

<!-- 出典・関連ページ -->
<h5>出典 :</h5>
<a href="https://docs.microsoft.com/ja-jp/dotnet/csharp/language-reference/tokens/interpolated">$ - 文字列補間 - C# リファレンス | Microsoft Docs</a><br>
<a href="https://docs.microsoft.com/ja-jp/dotnet/standard/base-types/composite-formatting#alignment-component">複合書式指定 | Microsoft Docs</a><br>

<!-- 目次 -->
<h5>目次 :</h5>
<div id="toc"></div>

<hr>

<!-- 本文ここから -->

<h2>C#における文字列リテラルの表現</h2>
C/C++同様に二重引用符で括ることで文字列を記述できる。<br>
また、二重引用符の前に<b class="red">@</b>を付与することで、エスケープシーケンスが無効化される<br>
⇒ 入力した内容がそのまま反映されるため、正規表現のメタ文字を表現する際などに有用。

<table>
<tr class="row1">
	<td class="col1"></td>
	<td>表現したい文字列</td>
	<td>無印<br>(通常の文字列表現)</td>
	<td><b class="red">@</b>付与<br>(エスケープシーケンス無効化)</td>
</tr>
<tr>
	<td class="col1">基本形</td>
	<td>Sample</td>
	<td>"Sample"</td>
	<td><b class="red">@</b>"Sample"</td>
</tr>
<tr>
	<td class="col1">二重引用符</td>
	<td><b class="magenta">"</b></td>
	<td>"<b class="magenta">\"</b>"</td>
	<td><b class="red">@</b>"<b class="magenta">""</b>"</td>
</tr>
<tr>
	<td class="col1">バックスラッシュ</td>
	<td><b class="magenta">\</b></td>
	<td>"<b class="magenta">\\</b>"</td>
	<td><b class="red">@</b>"<b class="magenta">\</b>"</td>
</tr>
<tr>
	<td class="col1">エスケープ文字</td>
	<td>(\r : 復帰改行)</td>
	<td>"<b class="magenta">\r</b>"</td>
	<td>(表現不可)</td>
</tr>
<tr>
	<td class="col1">改行を含む文字列</td>
	<td>Top<br>Middle<br>Bottom</td>
	<td>"Top<b class="magenta">\n</b>Middle<b class="magenta">\n</b>Bottom"</td>
	<td><b class="red">@</b>"Top<br>Middle<br>Bottom"</td>
</tr>

</table>

<h2>複合文字列と文字列補間</h2>
文字列中に変数の値やリテラルを埋め込むことができる。<br>
(文字列補間はC#6.0以降で使用可能)<br>
ブレース自身は<b class="magenta"> {{ </b>または<b class="magenta"> }} </b>

<table>
  <tr class="row1">
  <td class="col1">
  </td>
  <td>概要</td>
  <td>記述例</td>
  </tr>
  <tr>
    <td class="col1">複合文字列</td>
    <td>
    値を埋め込む位置に<br>
    <b class="dgreen">{[挿入子の指定順]}</b> (0 起算)<br>
    を記述、挿入子をカンマに続けて記述する。
    </td>
    <td>
コード<br>
<p class="code">
string name = <ltr>"Mark"</ltr>;
var date = DateTimeNow;

Console.WriteLine(<ltr>"Hello, <b class="dgreen">{0}</b>! Today is <b class="dgreen">{1}</b>, it's <b class="dgreen">{2:HH:mm}</b> now."</ltr>, name, date.DayOfWeek, date);
<cmt>//                         ↑            ↑        ↑              │    │              │</cmt>
<cmt>//                         └──────│────│───────┘    │              │</cmt>
<cmt>//                                       └────│──────────┘              │</cmt>
<cmt>//                                                 └──────────────────┘</cmt>
</p>
出力結果<br>
<p class="code">
Hello, Mark! Today is Wednesday, it's 19:40 now.
</p>
    </td>
  </tr>
    
  <tr>
    <td class="col1">文字列補間<br>(C# 6.0以降)</td>
    <td>
    文字列の先頭(二重引用符の前)に<b class="blue">$</b>を付与し、<br>
    値を埋め込む位置に<br>
    <b class="dgreen">{[挿入子]}</b><br>
    をそのまま記述する。<br>
    複合文字列を用いるよりも直観的な記述が可能。
    </td>
    <td>
コード<br>
<p class="code">
string name = <ltr>"Mark"</ltr>;
var date = DateTime.Now;

Console.WriteLine(<ltr><b class="blue">$</b>"Hello, <b class="dgreen">{name}</b>! Today is <b class="dgreen">{date.DayOfWeek}</b>, it's <b class="dgreen">{date:HH:mm}</b> now."</ltr>);
</p>
出力結果<br>
<p class="code">
Hello, Mark! Today is Wednesday, it's 19:40 now.
</p>
    </td>
  </tr>
</table>

<h3><b class="red">@</b>との併用</h3>
(文字列補間)<b class="blue">$</b><b class="red">@</b>"文字列"の形式で記述。<br>
(C#8.0以降は、<b class="red">@</b><b class="blue">$</b>でも可。)

<p class="code">
string str01 = <ltr><b class="blue">$</b><b class="red">@</b>"Mark <b class="dgreen">{</b>"Down"<b class="dgreen">}</b>"</ltr>; <cmt>//< 文字列にリテラルを埋め込む ⇒ Mark Down</cmt>
int i = 100;
string str02 = <ltr><b class="blue">$</b><b class="red">@</b>"<b class="dgreen">{</b>i<b class="dgreen">}</b> %"</ltr>;         <cmt>//< 文字列に変数値を埋め込む   ⇒ 100 %</cmt>
</p>

<h3>アラインメントの指定</h3>
挿入する値に続き、値を記述することで出力文字数とアラインメントを指定できる。<br>
詳細は<a href="https://docs.microsoft.com/ja-jp/dotnet/standard/base-types/composite-formatting/#alignment-component">リンク先</a>を参照。<br>

<ul>
<li>負値 : 左詰め</li>
<li>正値 : 右詰め</li>
</ul>
<p class="code">
string str01 = <ltr>$"|{"Mark", <b class="red">-7</b>}|"</ltr>;  <cmt>//< 7文字・左詰め ⇒ |Mark   |</cmt>
string str02 = <ltr>$"|{"Mark", <b class="red"> 7</b>}|"</ltr>;  <cmt>//< 7文字・右詰め ⇒ |   Mark|</cmt>
</p>

<h3>書式指定文字列</h3>
値(またはアラインメント指定)に続き、<b class="dgreen"> :[書式指定文字列]</b> の形式で、出力形式を指定できる。<br>
<b>書式指定文字列は二重引用符で囲んではならない</b>。

<p class="code">
var date = DateTime.Now;                         <cmt>//< 現在日時を取得</cmt>
string str01 = <ltr>$"It's {date, <b class="red">-7</b>, <b class="dgreen">:HH:MM</b>} now."</ltr>;  <cmt>//< 7文字・左詰め / <b class="dgreen">HH:MM</b>形式 ⇒ It's 17:35 now.</cmt>
</p>

コロンはそのままでは書式指定文字列の始点とみなされるため、コロンが特別な意味を持つ場合(三項演算子)は、条件式自体を丸括弧で囲む。
<p class="code">
int age = 34;
string str01 = <ltr>$"Johnny is {age} year{<b class="blue">(</b>age == 1 ? "" <b class="blue">:</b> "s"<b class="blue">)</b>} old."</ltr>;  <cmt>//< 補完式中で(三項)条件演算子を用いる場合 ⇒ Johnny is 34 years old.</cmt>

age = 1;
string str02 = <ltr>$"May is {age} year{<b class="blue">(</b>age == 1 ? "" <b class="blue">:</b> "s"<b class="blue">)</b>} old."</ltr>;     <cmt>//< 同上                                   ⇒ May is 1 year old.</cmt>
</p>


</body>
</html>
