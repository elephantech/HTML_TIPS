<!DOCTYPE html>

<html lang="ja">
<!-- --------------------------------------
head
--------------------------------------- -->
<head>
<meta content="text/html" charset="utf-8" http-equiv="Content-Type" />

<!-- 基準URI -->
<base href="file:///G:/共有ドライブ/098-all-employees/tips/HTML_TIPS/">

<!-- スタイルシート -->
<link rel="stylesheet" href="_Assets/Sytle001.css" type="text/css">

<!-- スクリプト -->
<!-- タイトル表示 -->
<script src="_Assets/MakeTitle.js" type="text/javascript"></script>
<!-- 目次表示 -->
<script src="_Assets/MakeToc_L.js" type="text/javascript"></script>



</head>

<!-- --------------------------------------
body
--------------------------------------- -->
<body>
<!-- ページタイトル(ページ内表示) -->
<span id="title"></span>
<!-- 出典・関連ページ -->
<h5>出典 :</h5>
<a href="
http://officetanaka.net/excel/excel2007/094.htm
">Office TANAKA - Excel 2007レビュー「奥が深いテーブル機能」</a>
<br>
<a href="
https://forest.watch.impress.co.jp/docs/serial/exceltips/1088973.html
">【Excel効率化】表は必ずテーブルにするのが吉！エクセルの表編集で無駄な作業を今すぐカットするテク - いまさら聞けないExcelの使い方講座 - 窓の杜</a>
<br>
<a href="
https://www.forguncy.com/blog/20161014_table
">Excelのテーブル機能の使い方まとめ | ノンプログラミングWebアプリ作成ツール - Forguncy（フォーガンシー）| グレープシティ株式会社</a>
<br>
<a href="
https://www.crie.co.jp/chokotech/detail/90/
">テーブルを使うメリット ―抽出したデータの計算―｜クリエアナブキのちょこテク</a>
<br>

<!-- 目次 -->
<h5>目次 :</h5>
<div id="toc"></div>

<hr>

<!-- 本文ここから -->


<h2>テーブルとは</h2>
ワークシートの特定の範囲を、<b>「(体系化された)データの一覧」としてExcelに認識させる</b>機能。<br>
テーブルを用いることで、範囲内のデータをデータベースのように扱うことができ、<br>
データを体系的に管理するための機能を用いることができるようになる。<br>
「ビボットテーブル」とは異なる。<br>

<h3>よくある誤解</h3>
<img src="_Img/MS Excel/table/01.png"><br>
テーブル作成時に「テーブルとして書式設定」という操作を経ることから、<br>
「テーブルは表を縞模様にする機能」と誤解されることが多いが、外観はあくまでテーブル機能の一部(スタイル)で、テーブルの本質ではない。<br>
(外観はテーブルスタイルから変更できるが、スタイルに依らず自由に設定することも可。)

<h2>テーブルの作成(セル範囲のテーブル化)</h2>
<img src="_Img/MS Excel/table/02.png"><br>

<ol>
<ol>
テーブル化したいセル範囲全体、またはそこに含まれるセル(いずれか一つでよい)を選択する。<br>
(Excelが自動で集計範囲を検出する。集計範囲は後から変更可能。)<br>
<img src="_Img/MS Excel/table/03.png"><br>
</li>

<ol>
「ホーム」>「スタイル」>「テーブルとして書式設定」を選択し、<br>
適用するスタイルをギャラリーから選択する。<br>
(スタイルは後から変更可能。)<br>
<img src="_Img/MS Excel/table/04.png"><br>
<img src="_Img/MS Excel/table/05.png"><br>
</li>

<ol>
集計範囲の設定が正しいか確認する。<br>
(正しくない場合、ここで範囲を変更できる。)<br>
先頭行を見出しとして使用する(見出し行を作成済)場合、「先頭行をテーブルの見出しとして使用する」にチェックを入れる。<br>
(チェックを入れない場合、見出し行が新たに作成される。)<br>
「OK」を押すと確定される。<br>
<img src="_Img/MS Excel/table/06.png"><br>
</li>

<ol>
設定したセル範囲がテーブル化され、「テーブル ツール」メニューが追加される。<br>
<img src="_Img/MS Excel/table/07.png"><br>
</li>
</li>

<h2>テーブル設定の変更</h2>
「テーブル ツール」メニューからテーブルの設定を変更可能。<br>
テーブル名を設定すると、以後その名称でテーブルにアクセス可能となる。<br>
<img src="_Img/MS Excel/table/08.png"><br>

<h2>データの追加・削除</h2>
<h3>行・列の追加</h3>
テーブル末尾(下端・右端)の直後にデータを記入すると、テーブルのデータとして追加され、テーブル範囲が自動的に拡張される。<br>
行を追加した場合、すぐ上の行に設定されている<b>数式、入力規則、書式(条件付き書式を含む)がコピーされる</b>。<br>
<img src="_Img/MS Excel/table/09.png"><br>

<h3>データの削除</h3>
テーブル中のセルを個別に削除することはできず、行または列単位の削除に制限される。<br>

<h3>数式の設定</h3>
テーブル中のセルに数式を設定すると、同じ列の全セルに数式がコピーされる。<br>
<img src="_Img/MS Excel/table/10.png"><br>

<h2>構造化参照</h2>
数式からテーブル中のデータを参照する際、「テーブル名」と「列名」でデータを指定することができる。<br>

<h3>テーブル外から参照</h3>
以下の形式で指定する。<br>
<table>
<tr>
<td>列全体</td>
<td>(テーブル名)[(列名)]</td>
</tr>
<tr>
<td>同じ行のデータ</td>
<td>(テーブル名)[@(列名)]</td>
</tr>
</table>
(同じ行以外を特定することはできない？)<br>
<img src="_Img/MS Excel/table/11.png"><br>

<h3>(自身の)テーブル内から参照</h3>
テーブル内から同じテーブル内の値を参照する場合、テーブル名は省略可能。それ以外はテーブル外から参照する場合と同様。<br>
但し、<b>「同じ行の列範囲(m列からn列まで)」を参照する場合は例外的に、テーブル名を省略できない</b>。<br>
(大括弧[]の書式にも注意)<br>
<img src="_Img/MS Excel/table/12.png"><br>

<h2>テーブルとVBA</h2>
VBAからもテーブル名と列名、(テーブル中の)行番号を指定して、抽象度を保ったままアクセスできるため相性が良い。<br>
(シート内における絶対位置に依存しないため、列を増減したり、テーブルをシート内で移動してもプログラムを変更する必要が無い)<br>
詳細は出典元などを参照。

</body>
</html>
