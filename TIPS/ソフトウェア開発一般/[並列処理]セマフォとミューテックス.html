<!DOCTYPE html>

<html lang="ja">
<!-- --------------------------------------
head
--------------------------------------- -->
<head>
<meta content="text/html" charset="utf-8" http-equiv="Content-Type" />

<!-- 基準URI -->
<base href="https://elephantech-html-tips-etc.on.drv.tw/HTML_TIPS/">

<!-- スタイルシート -->
<link rel="stylesheet" href="_Assets/CSS/Sytle001.css" type="text/css">

<!-- スクリプト -->
<!-- タイトル表示 -->
<script src="_Assets/MakeTitle.js" type="text/javascript"></script>
<!-- 目次表示 -->
<script src="_Assets/MakeToc_L.js" type="text/javascript"></script>



</head>

<!-- --------------------------------------
body
--------------------------------------- -->
<body>
<!-- ページタイトル(ページ内表示) -->
<span id="title"></span>

<!-- 出典・関連ページ -->
<h5>出典 :</h5>
<a href="https://ja.wikipedia.org/wiki/%E3%82%BB%E3%83%9E%E3%83%95%E3%82%A9">セマフォ - Wikipedia</a><br>

<h5>関連 :</h5>
<a href="TIPS/ソフトウェア開発一般/[%E4%B8%A6%E5%88%97%E5%87%A6%E7%90%86]%E3%82%BF%E3%82%B9%E3%82%AF(%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89)%E9%96%93%E9%80%9A%E4%BF%A1.html">[並列処理]タスク(スレッド)間通信</a><br>

<!-- 目次 -->
<h5>目次 :</h5>
<div id="toc"></div>

<hr>

<!-- 本文ここから -->


<h2>セマフォ(Semaphore)とは</h2>
並列プログラミング(マルチタスク)環境において、プログラムの実行単位(タスク)間で共有する資源へのアクセスを制御する機構。多くのオペレーティングシステムで提供されている。<br>
各タスクが共有資源へのアクセスを安全に(競合することなく)行うために、同時アクセスの本数を(資源の数を超えないよう)制限し、<br>
資源(へのアクセス権)に空きが無い場合は、最後にアクセスしようとしたタスクを空きができるまで待たせる機能を有している。<br>
セマフォ(カウンティングセマフォ)は、有限個の資源へのアクセスをセマフォカウンタによって制御する。<br>
セマフォカウンタの値が、現在アクセス可能な資源の残数を表しており、<br>
資源を獲得する際にカウンタを減算(P操作)、使用後の資源を解放(返却)する際にカウンタを加算(V操作)する。即ち、<br>
<ol>
<li>資源を獲得する(P操作)</li>
<li>資源を使用する</li>
<li>資源を解放する(V操作)</li>
</ol>

が、セマフォを使用する際の一連の流れとなる。<br>
<img src="_Img/Software Development/Semaphore_Mutex/development-semaphore-and-mutex_01.png" alt="画像"><br>
管理する資源の個数が 1 のセマフォをバイナリセマフォと呼ぶ。バイナリセマフォはミューテックスと基本的には等価である。<br>

<h3>注意すべき点</h3>
複数の資源に対して使用する(セマフォカウンタの初期値が1を超える)場合、セマフォは単に個数のみを保持する。即ち、空いている資源のいずれを獲得するかを選択することはできない。<br>
セマフォの使用に当たり、以下のような操作は禁忌である。<br>
行った場合、その資源の使用に際しての公平性・安全性が損なわれ、プログラムの性能低下・不正動作・フリーズ・クラッシュなどの要因となる。<br>
<ul>
<li>資源を要求(獲得)しておいて、使用後に解放し忘れる</li>
<li>要求していない資源を使用する</li>
<li>解放済みの資源を使用する</li>
<li>要求したことのない資源を解放する</li>
<li>使用していない資源を長期間獲得したままにする</li>
</ul>

<h2>ミューテックス(Mutex)とは</h2>
2つの実行単位(タスク)が共用資源にアクセスするのを防止するための機構。<br>
先述の通りバイナリセマフォ(セマフォカウンタのとり得る値が 0 と 1 )と基本的には等価であり、システムによっては実装が同一である。<br>
ただし意味づけには若干の差異があり、ミューテックスが実行単位に結びついているのに対し、セマフォは資源に結びついている。<br>
即ち、ミューテックスは2つの実行単位の排他制御に用いられ(複数の資源を管理することもある)、<br>
(バイナリ)セマフォは一つの資源の排他制御に用いられる(実行単位がいくつあるかは問わない)。<br>

</body>
</html>
