<!DOCTYPE html>

<html lang="ja">
<!-- --------------------------------------
head
--------------------------------------- -->
<head>
<meta content="text/html" charset="utf-8" http-equiv="Content-Type" />

<!-- 基準URI -->
<base href="file:///G:/共有ドライブ/098-all-employees/tips/HTML_TIPS/">

<!-- スタイルシート -->
<link rel="stylesheet" href="_Assets/Sytle001.css" type="text/css">

<!-- スクリプト -->
<!-- タイトル表示 -->
<script src="_Assets/MakeTitle.js" type="text/javascript"></script>
<!-- 目次表示 -->
<script src="_Assets/MakeToc_L.js" type="text/javascript"></script>



</head>

<!-- --------------------------------------
body
--------------------------------------- -->
<body>
<!-- ページタイトル(ページ内表示) -->
<span id="title"></span>

<!-- 出典・関連ページ -->

<!-- 目次 -->
<h5>目次 :</h5>
<div id="toc"></div>

<hr>

<!-- 本文ここから -->

<h2>アプリケーションからフォームを開いた際の挙動</h2>
フォームを開く際に <b>Show()</b> と <b>ShowDialog()</b> のいずれを用いるかで、タスクの挙動が異なる。
<table>
    <tr class="row1">
        <td class="col1">開く際のメソッド</td>
        <td>フォームの形態</td>
    </tr>
    <tr>
        <td class="col1">Form.Show()</td>
        <td><b>モードレス(非同期)</b><br>別タスクとして開くため、元アプリケーションの処理が継続される</td>
    </tr>
    <tr>
        <td class="col1">Form.ShowDialog()</td>
        <td><b>モーダル(同期)</b><br>フォームを閉じるまでの間、元アプリケーションの処理が中断される</td>
    </tr>
</table>

<h3>サンプルコード : モードレス</h3>
<p class="code">
    <cmt>// フォームインスタンス生成</cmt>
    Form_Sub form_Sub = <kwd>new</kwd> Form_Sub();

    <cmt>// form_Sub をモードレスダイアログとして開く</cmt>
    form_Sub.<b>Show</b>();

    <cmt>// form_Sub を開いた直後に、後続行が実行される</cmt>
    <cmt>// (form_Sub を閉じたかは問われない)</cmt>
    Hoge();

    Fuga();

    :
</p>

<h3>サンプルコード : モーダル</h3>
<p class="code">
    <cmt>// フォームインスタンス生成</cmt>
    Form_Sub form_Sub = <kwd>new</kwd> Form_Sub();

    <cmt>// form_Sub をモーダルダイアログとして開く</cmt>
    form_Sub.<b>ShowDialog</b>();

    <cmt>// form_Sub を閉じるまで後続行は実行されない</cmt>
    Hoge();

    Fuga();

    :
</p>

<h2>フォームの処理結果(DialogResult)</h2>
フォームの処理結果を <b>DialogResult</b> プロパティ(DialogResult 型)から参照することができる。

<h3>DialogResult の確定</h3>
<p class="code">
<kwd>public partial class</kwd> Form_Sub : Form
{
    <kwd>public</kwd> Form_Sub()
    {
        InitializeComponent();
    }
<cmt>
    // - = - = - = - = - = - = - = - = - = - = - = - = - = - = - = -
    // ボタン「はい」クリック時の処理
    // - = - = - = - = - = - = - = - = - = - = - = - = - = - = - = -</cmt>
    <kwd>private void</kwd> button_Yes_Click(object sender, EventArgs e)
    {
        <b>DialogResult = DialogResult.Yes</b>;
    }
<cmt>
    // - = - = - = - = - = - = - = - = - = - = - = - = - = - = - = -
    // ボタン「いいえ」クリック時の処理
    // - = - = - = - = - = - = - = - = - = - = - = - = - = - = - = -</cmt>
    <kwd>private void</kwd> button_No_Click(object sender, EventArgs e)
    {
        <b>DialogResult = DialogResult.No</b>;
    }
}
</p>
DialogResult プロパティの初期値は DialogResult.None 。<br>
DialogResult プロパティの値を更新すると自動的にフォームが閉じられるため、Close() を明示的にコールする必要は無い。<br>

<h3>DialogResult を元アプリケーションから参照</h3>
<p class="code">
    <cmt>// フォームインスタンス生成</cmt>
    Form_Sub form_Sub = <kwd>new</kwd> Form_Sub();

    <cmt>// form_Sub をモーダルダイアログとして開く</cmt>
    form_Sub.<b>ShowDialog</b>();

    <cmt>// form_Sub の実行結果(DialogResult)を参照</cmt>
    <kwd>if</kwd> (form_Sub.<b>DialogResult</b> == <b>DialogResult.No</b>)
    {
        <kwd>return</kwd>;
    }

    :
</p>
フォームの実行結果を参照する場合、<b>フォームをモーダルで開く( ShowDialog() )のが通例</b>。<br>
上記のコードでは form_Sub を閉じるまで後続の処理( if 文以降)が行われないため、単純な処理で DialogResult を確定させてから判定することができる。<br>
この ShowDialog() を Show() に置き換えた場合、フォームはモードレスで開かれるため、if 文では DialogResult の初期値( DialogResult.None )を参考することになり意味を成さない。<br>
モードレスダイアログの DialogResult を参照するには、元アプリからのポーリングや、フォームからイベントを発行する(フォームが閉じられたことを通知する)などの機構を用意する必要があるが、ここでは割愛する。<br>


</body>
</html>

